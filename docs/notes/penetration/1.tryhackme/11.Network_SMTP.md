---
title: 常见的网络服务-SMTP
createTime: 2024/11/26 13:03:31
permalink: /penetration/qu9kpdsk/
---
## SMTP
SMTP (Simple Mail Transfer Protocol)  简单邮件传输协议
- **端口25**
- 用于处理电子邮件的发送
-  需要与`POP`/`IMAP`（用于检索传入邮件）结合形成协议对，才能完成邮件的发送和接收服务。
SMTP服务的三个基本功能：
- 验证谁通过SMTP服务发送邮件
- 向外发送邮件
- 如果邮件无法发送，将信息返回发件人


## POP and IMAP

**POP**（Post Office Protocol）邮局协议和**IMAP**（Internet Message Access Protocol）互联网消息访问协议都是**负责在客户端和邮件服务器之间传输邮件的电子协议。** 
- POP： 从邮件服务器下载整个收件箱到客户端
- IMAP：多端同步收件箱（任何修改，都会保存到邮件服务器）
## 电子邮件如何完成传递

![](assets/11.network_smtp/untitled_1.png)
1. **客户端与SMTP服务器建立连接**：邮件用户代理（电子邮件客户端或外部程序）连接到SMTP服务器（例如：smtp.google.com）。
	- SMTP握手->建立并验证连接->SMTP会话启动
2. **客户端向服务器发送邮件**：
	- 邮件地址
	- 邮件正文
	- 邮件附件
3. **SMTP服务器检查域名**： 检查收件人和发件人的域名是否相同
4. **SMTP服务器建立连接**：
	- 发件人的SMTP服务器将在中继电子邮件之前与收件人的SMTP服务器建立连接。
	- 如果收件人的服务器无法访问或不可用-电子邮件将被放入SMTP队列（`smtp queue`）。
5. **收件人服务器验证传入邮件**：检查域名和用户名是否已被识别。
6. **将邮件发送到POP/IMAP服务器**
7. **电子邮件显示在收件人的邮箱中**
这是一个非常简化的过程版本，还有很多子协议、通信和细节没有包括在内。如果你想了解更多细节，请仔细阅读：

```cardlink
url: https://computer.howstuffworks.com/e-mail-messaging/email3.htm
title: "How Email Works"
description: "Email gives us the ability to contact any person in the world in a matter of seconds. Find out how email works and how email servers deliver messages."
host: computer.howstuffworks.com
favicon: https://cdn.hswstatic.com/en-us/hsw/img/icons/favicon.svg
image: https://cdn.hswstatic.com/gif/email-katrina.jpg
```

## SMTP 运行环境

SMTP服务器软件在windwos上很常见，在Linux 上也有许多SMTP变体可以运行。
这里有一个资源，它解释了SMTP的技术实现和工作，比我在这里介绍的更详细。

```cardlink
url: https://www.afternerd.com/blog/smtp/
title: "SMTP protocol Explained (How Email works?) - Afternerd"
description: "Ever wondered what happens after you compose an email to your friend and then click the “send” button? In this article, I am going to teach you the SMTP protocol by following the journey of an email message from when you click the “send” button until it lands in your friend’s mailbox."
host: www.afternerd.com
favicon: https://www.afternerd.com/blog/wp-content/uploads/2020/06/cropped-android-chrome-512x512-32x32.png
image: https://www.afternerd.com/blog/wp-content/uploads/2017/11/youvegotmail.jpg
```

```ad-details
collapse: true
title: What does SMTP stand for?
**答案** `Simple Mail Transfer Protocol`
```

```ad-details
collapse:true
title: What dose SMTP handle the sending of? (anser in plural)
**答案**：`emails`
```

```ad-details
collapse:true
title: What is the first step in the SMTP procsess ？
**答案**：`SMTP handshake`
```

```ad-details
collapse:true
title: What is the default SMTP port ?
**答案**：`25`
```

```ad-details
collapse:true
title: 如果收件人服务器不可用，SMTP服务器将电子邮件发送到哪里？
**答案**：`smtp queue`
```

```ad-details
collapse:true
title: 电子邮件最终会在哪个服务器上结束？
**答案**：`POP/IMAP`
```

```ad-details
collapse:true
title: Linux机器可以运行SMTP服务器吗（是/否） ? 
**答案**：`Y`
```

```ad-details
collapse:true
title: Windows机器可以运行SMTP服务器吗（是/否） ? 
**答案**：`Y`
```

## SMTP枚举

